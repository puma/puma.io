<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Puma::DSL &mdash; Puma-6.2.1</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Puma::DSL",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Puma-6.2.1</a> &raquo; 
      <a href='../_index.html#alpha_D'>Index (D)</a> &raquo; 
        <a href="../Puma.html" title="Puma (module)">Puma</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>DSL&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Puma::DSL</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L51'>lib/puma/dsl.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The methods that are available for use inside the configuration file. These same methods are used in <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> cli and the rack handler internally.</p>

<p>Used manually (via <a href="CLI.html" title="Puma::CLI (class)"><code>CLI</code></a> class):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'><a href="Configuration.html" title="Puma::Configuration (class)">Configuration</a></span>.<span class='id identifier rubyid_new'><a href="Configuration.html#new-class_method" title="Puma::Configuration.new (method)">new</a></span>({}) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user_config'>user_config</span><span class='op'>|</span>
  <span class='id identifier rubyid_user_config'>user_config</span>.<span class='id identifier rubyid_port'><a href="#port-instance_method" title="Puma::DSL#port (method)">port</a></span> <span class='int'>3001</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_load'><a href="#load-instance_method" title="Puma::DSL#load (method)">load</a></span>

<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binds'>binds</span>] <span class='comment'># =&gt; &quot;tcp://127.0.0.1:3001&quot;</span></code></pre>

<p>Used to load file:</p>

<pre class="code ruby"><code class="ruby">$ cat puma_config.rb
port 3002</code></pre>

<p>Resulting configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'><a href="Configuration.html" title="Puma::Configuration (class)">Configuration</a></span>.<span class='id identifier rubyid_new'><a href="Configuration.html#new-class_method" title="Puma::Configuration.new (method)">new</a></span>(<span class='label'>config_file:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>puma_config.rb</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_load'><a href="#load-instance_method" title="Puma::DSL#load (method)">load</a></span>

<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binds'>binds</span>] <span class='comment'># =&gt; &quot;tcp://127.0.0.1:3002&quot;</span></code></pre>

<p>You can also find many examples being used by the test suite in <code>test/config</code>.</p>

<p><a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> v6 adds the option to specify a key name (String or Symbol) to the hooks that run inside the forked workers.  All the hooks run inside the <a href="Cluster/Worker.html#run-instance_method" title="Puma::Cluster::Worker#run (method)">Cluster::Worker#run</a> method.</p>

<p>Previously, the worker index and the <a href="LogWriter.html" title="Puma::LogWriter (class)"><code>LogWriter</code></a> instance were passed to the hook blocks/procs.  If a key name is specified, a hash is passed as the last parameter.  This allows storage of data, typically objects that are created before the worker that need to be passed to the hook when the worker is shutdown.</p>

<p>The following hooks have been updated:</p>

<pre class="code ruby"><code class="ruby">| DSL Method         |  Options Key            | Fork Block Location |
| on_worker_boot     | :before_worker_boot     | inside, before      |
| on_worker_shutdown | :before_worker_shutdown | inside, after       |
| on_refork          | :before_refork          | inside              |</code></pre>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ON_WORKER_KEY-constant' class='summary_signature'>ON_WORKER_KEY =</span>
    <br/>
    <a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L52-L52'># File 'lib/puma/dsl.rb', line 52</a>    <pre class='code ruby'>[<span class='const'>String</span><span class='comma'>,</span> <span class='const'>Symbol</span>].<span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(options, config)  &#x21d2; DSL </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ssl_bind_str-class_method" title=".ssl_bind_str (class method)">.<strong>ssl_bind_str</strong>(host, port, opts)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>convenience method so logic can be used in CI.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#_load_from-instance_method" title="#_load_from (instance method)">#<strong>_load_from</strong>(path)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#_offer_plugins-instance_method" title="#_offer_plugins (instance method)">#<strong>_offer_plugins</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#activate_control_app-instance_method" title="#activate_control_app (instance method)">#<strong>activate_control_app</strong>(url = &quot;auto&quot;, opts = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Start the <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> control rack application on <code>url</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#after_worker_boot-instance_method" title="#after_worker_boot (instance method)">#<strong>after_worker_boot</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#after_worker_fork-instance_method" title="Puma::DSL#after_worker_fork (method)">#after_worker_fork</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#after_worker_fork-instance_method" title="#after_worker_fork (instance method)">#<strong>after_worker_fork</strong>(&amp;block)  </a>
      (also: #after_worker_boot)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run in the master after a worker has been started.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#app-instance_method" title="#app (instance method)">#<strong>app</strong>(obj = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Use an object or block as the rack application.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#before_fork-instance_method" title="#before_fork (instance method)">#<strong>before_fork</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run immediately before master process forks workers (once on boot).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bind-instance_method" title="#bind (instance method)">#<strong>bind</strong>(url)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Bind the server to <code>url</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bind_to_activated_sockets-instance_method" title="#bind_to_activated_sockets (instance method)">#<strong>bind_to_activated_sockets</strong>(bind = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Bind to (systemd) activated sockets, regardless of configured binds.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#clean_thread_locals-instance_method" title="#clean_thread_locals (instance method)">#<strong>clean_thread_locals</strong>(which = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Work around leaky apps that leave garbage in Thread locals across requests.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#clear_binds!-instance_method" title="#clear_binds! (instance method)">#<strong>clear_binds!</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#custom_logger-instance_method" title="#custom_logger (instance method)">#<strong>custom_logger</strong>(custom_logger)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Pass in a custom logging class instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#debug-instance_method" title="#debug (instance method)">#<strong>debug</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Show debugging info.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#default_host-instance_method" title="#default_host (instance method)">#<strong>default_host</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#directory-instance_method" title="#directory (instance method)">#<strong>directory</strong>(dir)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The directory to operate out of.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#drain_on_shutdown-instance_method" title="#drain_on_shutdown (instance method)">#<strong>drain_on_shutdown</strong>(which = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When shutting down, drain the accept socket of pending connections and process them.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#early_hints-instance_method" title="#early_hints (instance method)">#<strong>early_hints</strong>(answer = true)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#environment-instance_method" title="#environment (instance method)">#<strong>environment</strong>(environment)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the environment in which the rack’s app will run.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#extra_runtime_dependencies-instance_method" title="#extra_runtime_dependencies (instance method)">#<strong>extra_runtime_dependencies</strong>(answer = [])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When using prune_bundler, if extra runtime dependencies need to be loaded to initialize your app, then this setting can be used.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#first_data_timeout-instance_method" title="#first_data_timeout (instance method)">#<strong>first_data_timeout</strong>(seconds)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Define how long the tcp socket stays open, if no data has been received.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#force_shutdown_after-instance_method" title="#force_shutdown_after (instance method)">#<strong>force_shutdown_after</strong>(val = :forever)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>How long to wait for threads to stop when shutting them down.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#fork_worker-instance_method" title="#fork_worker (instance method)">#<strong>fork_worker</strong>(after_requests = 1000)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When enabled, workers will be forked from worker 0 instead of from the master process.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get-instance_method" title="#get (instance method)">#<strong>get</strong>(key, default = nil)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#http_content_length_limit-instance_method" title="#http_content_length_limit (instance method)">#<strong>http_content_length_limit</strong>(limit)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The default value for http_content_length_limit is nil.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inject-instance_method" title="#inject (instance method)">#<strong>inject</strong>(&amp;blk)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#io_selector_backend-instance_method" title="#io_selector_backend (instance method)">#<strong>io_selector_backend</strong>(backend)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specify the backend for the <a href="../IO.html" title="IO (class)"><code>::IO</code></a> selector.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#load-instance_method" title="#load (instance method)">#<strong>load</strong>(file)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Load additional configuration from a file Files get loaded later via <a href="Configuration.html#load-instance_method" title="Puma::Configuration#load (method)">Configuration#load</a></p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#log_formatter-instance_method" title="#log_formatter (instance method)">#<strong>log_formatter</strong>(&amp;block)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#log_requests-instance_method" title="#log_requests (instance method)">#<strong>log_requests</strong>(which = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Enable request logging.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#lowlevel_error_handler-instance_method" title="#lowlevel_error_handler (instance method)">#<strong>lowlevel_error_handler</strong>(obj = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Use <code>obj</code> or <code>block</code> as the low level error handler.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#max_fast_inline-instance_method" title="#max_fast_inline (instance method)">#<strong>max_fast_inline</strong>(num_of_requests)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The number of requests to attempt inline before sending a client back to the reactor to be subject to normal ordering.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#mutate_stdout_and_stderr_to_sync_on_write-instance_method" title="#mutate_stdout_and_stderr_to_sync_on_write (instance method)">#<strong>mutate_stdout_and_stderr_to_sync_on_write</strong>(enabled = true)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_booted-instance_method" title="#on_booted (instance method)">#<strong>on_booted</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run after puma is booted (works for both: single and clustered).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_refork-instance_method" title="#on_refork (instance method)">#<strong>on_refork</strong>(key = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When <a href="#fork_worker-instance_method" title="Puma::DSL#fork_worker (method)">#fork_worker</a> is enabled, code to run in Worker 0 before all other workers are re-forked from this process, after the server has temporarily stopped serving requests (once per complete refork cycle).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_restart-instance_method" title="#on_restart (instance method)">#<strong>on_restart</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run before doing a restart.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_worker_boot-instance_method" title="#on_worker_boot (instance method)">#<strong>on_worker_boot</strong>(key = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run in a worker when it boots to setup the process before booting the app.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_worker_fork-instance_method" title="#on_worker_fork (instance method)">#<strong>on_worker_fork</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run in the master right before a worker is started.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#on_worker_shutdown-instance_method" title="#on_worker_shutdown (instance method)">#<strong>on_worker_shutdown</strong>(key = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run immediately before a worker shuts down (after it has finished processing HTTP requests).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#out_of_band-instance_method" title="#out_of_band (instance method)">#<strong>out_of_band</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Code to run out-of-band when the worker is idle.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#persistent_timeout-instance_method" title="#persistent_timeout (instance method)">#<strong>persistent_timeout</strong>(seconds)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Define how long persistent connections can be idle before <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> closes them.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pidfile-instance_method" title="#pidfile (instance method)">#<strong>pidfile</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Store the pid of the server in the file at “path”.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#plugin-instance_method" title="#plugin (instance method)">#<strong>plugin</strong>(name)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Load the named plugin for use by this configuration.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#port-instance_method" title="#port (instance method)">#<strong>port</strong>(port, host = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Define the TCP port to bind to.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#preload_app!-instance_method" title="#preload_app! (instance method)">#<strong>preload_app!</strong>(answer = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Preload the application before starting the workers; this conflicts with phased restart feature.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#prune_bundler-instance_method" title="#prune_bundler (instance method)">#<strong>prune_bundler</strong>(answer = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This option is used to allow your app and its gems to be properly reloaded when not using preload.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#queue_requests-instance_method" title="#queue_requests (instance method)">#<strong>queue_requests</strong>(answer = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When set to true (the default), workers accept all requests and queue them before passing them to the handlers.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#quiet-instance_method" title="#quiet (instance method)">#<strong>quiet</strong>(which = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disable request logging, if this isn’t used it’ll be enabled by default.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#rack_url_scheme-instance_method" title="#rack_url_scheme (instance method)">#<strong>rack_url_scheme</strong>(scheme = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows setting <code>env[&#39;rack.url_scheme&#39;]</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#rackup-instance_method" title="#rackup (instance method)">#<strong>rackup</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Load <code>path</code> as a rackup file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#raise_exception_on_sigterm-instance_method" title="#raise_exception_on_sigterm (instance method)">#<strong>raise_exception_on_sigterm</strong>(answer = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>By default, <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> will raise SignalException when SIGTERM is received.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#restart_command-instance_method" title="#restart_command (instance method)">#<strong>restart_command</strong>(cmd)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Command to use to restart <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_default_host-instance_method" title="#set_default_host (instance method)">#<strong>set_default_host</strong>(host)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#set_remote_address-instance_method" title="#set_remote_address (instance method)">#<strong>set_remote_address</strong>(val = :socket)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Control how the remote address of the connection is set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#shutdown_debug-instance_method" title="#shutdown_debug (instance method)">#<strong>shutdown_debug</strong>(val = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>When a shutdown is requested, the backtraces of all the threads will be written to $stdout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#silence_fork_callback_warning-instance_method" title="#silence_fork_callback_warning (instance method)">#<strong>silence_fork_callback_warning</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disable warning message when running single mode with callback hook defined.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#silence_single_worker_warning-instance_method" title="#silence_single_worker_warning (instance method)">#<strong>silence_single_worker_warning</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disable warning message when running in cluster mode with a single worker.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ssl_bind-instance_method" title="#ssl_bind (instance method)">#<strong>ssl_bind</strong>(host, port, opts = {})  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Instead of using <a href="#bind-instance_method" title="Puma::DSL#bind (method)">#bind</a> and manually constructing a URI like:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#state_path-instance_method" title="#state_path (instance method)">#<strong>state_path</strong>(path)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Use <code>path</code> as the file to store the server info state.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#state_permission-instance_method" title="#state_permission (instance method)">#<strong>state_permission</strong>(permission)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Use <code>permission</code> to restrict permissions for the state file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#stdout_redirect-instance_method" title="#stdout_redirect (instance method)">#<strong>stdout_redirect</strong>(stdout = nil, stderr = nil, append = false)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Redirect <code>STDOUT</code> and <code>STDERR</code> to files specified.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#tag-instance_method" title="#tag (instance method)">#<strong>tag</strong>(string)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Additional text to display in process listing.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#threads-instance_method" title="#threads (instance method)">#<strong>threads</strong>(min, max)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Configure <code>min</code> to be the minimum number of threads to use to answer requests and <code>max</code> the maximum.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#wait_for_less_busy_worker-instance_method" title="#wait_for_less_busy_worker (instance method)">#<strong>wait_for_less_busy_worker</strong>(val = 0.005)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Attempts to route traffic to less-busy workers by causing them to delay listening on the socket, allowing workers which are not processing any requests to pick up new requests first.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_boot_timeout-instance_method" title="#worker_boot_timeout (instance method)">#<strong>worker_boot_timeout</strong>(timeout)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Change the default worker timeout for booting.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_check_interval-instance_method" title="#worker_check_interval (instance method)">#<strong>worker_check_interval</strong>(interval)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Change the default interval for checking workers.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_culling_strategy-instance_method" title="#worker_culling_strategy (instance method)">#<strong>worker_culling_strategy</strong>(strategy)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the strategy for worker culling.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_shutdown_timeout-instance_method" title="#worker_shutdown_timeout (instance method)">#<strong>worker_shutdown_timeout</strong>(timeout)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the timeout for worker shutdown.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#worker_timeout-instance_method" title="#worker_timeout (instance method)">#<strong>worker_timeout</strong>(timeout)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Verifies that all workers have checked in to the master process within the given timeout.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#workers-instance_method" title="#workers (instance method)">#<strong>workers</strong>(count)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>How many worker processes to run.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#add_pem_values_to_options_store-instance_method" title="#add_pem_values_to_options_store (instance method)">#<strong>add_pem_values_to_options_store</strong>(opts)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>To avoid adding cert_pem and key_pem as URI params, we store them on the <a href=":store">options</a> from where <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> binder knows how to find and extract them.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#process_hook-instance_method" title="#process_hook (instance method)">#<strong>process_hook</strong>(options_key, key, block, meth)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#warn_if_in_single_mode-instance_method" title="#warn_if_in_single_mode (instance method)">#<strong>warn_if_in_single_mode</strong>(hook_name)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(options, config)  &#x21d2; <code>DSL</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L122-L127'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='122' data-end='127'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 122</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span>)
  <span class='ivar'>@config</span>  <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>

  <span class='ivar'>@plugins</span> <span class='op'>=</span> []
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="ssl_bind_str-class_method">
  <h3 class='signature  first'>
    .<strong>ssl_bind_str</strong>(host, port, opts)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>convenience method so logic can be used in CI</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#ssl_bind-instance_method" title="Puma::DSL#ssl_bind (method)">#ssl_bind</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L57-L120'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='57' data-end='120'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 57</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_ssl_bind_str'>ssl_bind_str</span>(<span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'><a href="#port-instance_method" title="Puma::DSL#port (method)">port</a></span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span>)
  <span class='id identifier rubyid_verify'>verify</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_verify_mode'>verify_mode</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>none</span><span class='tstring_end'>&#39;</span></span>).<span class='id identifier rubyid_to_s'>to_s</span>

  <span class='id identifier rubyid_tls_str'>tls_str</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_no_tlsv1_1'>no_tlsv1_1</span>]  <span class='kw'>then</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&amp;no_tlsv1_1=true</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_no_tlsv1'>no_tlsv1</span>] <span class='kw'>then</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&amp;no_tlsv1=true</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>else</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>

  <span class='id identifier rubyid_ca_additions'>ca_additions</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;ca=</span><span class='embexpr_beg'>#{</span><span class='const'><a href="../Puma.html" title="Puma (module)">Puma</a></span><span class='op'>::</span><span class='const'><a href="Util.html" title="Puma::Util (module)">Util</a></span>.<span class='id identifier rubyid_escape'><a href="Util.html#escape-class_method" title="Puma::Util.escape (method)">escape</a></span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ca'>ca</span>])<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>peer</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>force_peer</span><span class='tstring_end'>&#39;</span></span>].<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_verify'>verify</span>)

  <span class='id identifier rubyid_low_latency_str'>low_latency_str</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_low_latency'>low_latency</span>) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;low_latency=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_low_latency'>low_latency</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_backlog_str'>backlog_str</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_backlog'>backlog</span>] <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;backlog=</span><span class='embexpr_beg'>#{</span><span class='const'>Integer</span>(<span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_backlog'>backlog</span>])<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='const'>JRUBY_VERSION</span>)
    <span class='id identifier rubyid_cipher_suites'>cipher_suites</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ssl_cipher_list'>ssl_cipher_list</span>] <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;ssl_cipher_list=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ssl_cipher_list'>ssl_cipher_list</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span> <span class='comment'># old name
</span>    <span class='id identifier rubyid_cipher_suites'>cipher_suites</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cipher_suites'>cipher_suites</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;cipher_suites=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cipher_suites'>cipher_suites</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cipher_suites'>cipher_suites</span>]
    <span class='id identifier rubyid_protocols'>protocols</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_protocols'>protocols</span>] <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;protocols=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_protocols'>protocols</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span>

    <span class='id identifier rubyid_keystore_additions'>keystore_additions</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>keystore=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_keystore'>keystore</span>]<span class='embexpr_end'>}</span><span class='tstring_content'>&amp;keystore-pass=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_keystore_pass'>keystore_pass</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_keystore_additions'>keystore_additions</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_keystore_additions'>keystore_additions</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;keystore-type=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_keystore_type'>keystore_type</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_keystore_type'>keystore_type</span>]
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_truststore'>truststore</span>]
      <span class='id identifier rubyid_truststore_additions'>truststore_additions</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;truststore=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_truststore'>truststore</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_truststore_additions'>truststore_additions</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_truststore_additions'>truststore_additions</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;truststore-pass=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_truststore_pass'>truststore_pass</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_truststore_pass'>truststore_pass</span>]
      <span class='id identifier rubyid_truststore_additions'>truststore_additions</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_truststore_additions'>truststore_additions</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;truststore-type=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_truststore_type'>truststore_type</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_truststore_type'>truststore_type</span>]
    <span class='kw'>end</span>

    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ssl://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'><a href="#port-instance_method" title="Puma::DSL#port (method)">port</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>?</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_keystore_additions'>keystore_additions</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_truststore_additions'>truststore_additions</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cipher_suites'>cipher_suites</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_protocols'>protocols</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;verify_mode=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_verify'>verify</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tls_str'>tls_str</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ca_additions'>ca_additions</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_backlog_str'>backlog_str</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_ssl_cipher_filter'>ssl_cipher_filter</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ssl_cipher_filter'>ssl_cipher_filter</span>] <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;ssl_cipher_filter=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_ssl_cipher_filter'>ssl_cipher_filter</span>]<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_v_flags'>v_flags</span> <span class='op'>=</span> (<span class='id identifier rubyid_ary'>ary</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_verification_flags'>verification_flags</span>]) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;verification_flags=</span><span class='embexpr_beg'>#{</span><span class='const'>Array</span>(<span class='id identifier rubyid_ary'>ary</span>).<span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span>

    <span class='id identifier rubyid_cert_flags'>cert_flags</span> <span class='op'>=</span> (<span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_cert'>cert</span>]) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cert=</span><span class='embexpr_beg'>#{</span><span class='const'><a href="../Puma.html" title="Puma (module)">Puma</a></span><span class='op'>::</span><span class='const'><a href="Util.html" title="Puma::Util (module)">Util</a></span>.<span class='id identifier rubyid_escape'><a href="Util.html#escape-class_method" title="Puma::Util.escape (method)">escape</a></span>(<span class='id identifier rubyid_cert'>cert</span>)<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_key_flags'>key_flags</span> <span class='op'>=</span> (<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_key'>key</span>]) <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;key=</span><span class='embexpr_beg'>#{</span><span class='const'><a href="../Puma.html" title="Puma (module)">Puma</a></span><span class='op'>::</span><span class='const'><a href="Util.html" title="Puma::Util (module)">Util</a></span>.<span class='id identifier rubyid_escape'><a href="Util.html#escape-class_method" title="Puma::Util.escape (method)">escape</a></span>(<span class='id identifier rubyid_key'>key</span>)<span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span>

    <span class='id identifier rubyid_reuse_flag'>reuse_flag</span> <span class='op'>=</span>
      <span class='kw'>if</span> (<span class='id identifier rubyid_reuse'>reuse</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_reuse'>reuse</span>])
        <span class='kw'>if</span> <span class='id identifier rubyid_reuse'>reuse</span> <span class='op'>==</span> <span class='kw'>true</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&amp;reuse=dflt</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_reuse'>reuse</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'>Hash</span>) <span class='op'>&amp;&amp;</span> (<span class='id identifier rubyid_reuse'>reuse</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_size'>size</span>) <span class='op'>||</span> <span class='id identifier rubyid_reuse'>reuse</span>.<span class='id identifier rubyid_key?'>key?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_timeout'>timeout</span>))
          <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
          <span class='kw'>if</span> (<span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_reuse'>reuse</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_size'>size</span>]) <span class='op'>&amp;&amp;</span> <span class='const'>Integer</span> <span class='op'>===</span> <span class='id identifier rubyid_size'>size</span>
            <span class='id identifier rubyid_val'>val</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_size'>size</span>.<span class='id identifier rubyid_to_s'>to_s</span>
          <span class='kw'>end</span>
          <span class='kw'>if</span> (<span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_reuse'>reuse</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_timeout'>timeout</span>]) <span class='op'>&amp;&amp;</span> <span class='const'>Integer</span> <span class='op'>===</span> <span class='id identifier rubyid_timeout'>timeout</span>
            <span class='id identifier rubyid_val'>val</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_timeout'>timeout</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_empty?'>empty?</span>
            <span class='kw'>nil</span>
          <span class='kw'>else</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&amp;reuse=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val'>val</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>else</span>
          <span class='kw'>nil</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='kw'>nil</span>
      <span class='kw'>end</span>

    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ssl://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'><a href="#port-instance_method" title="Puma::DSL#port (method)">port</a></span><span class='embexpr_end'>}</span><span class='tstring_content'>?</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cert_flags'>cert_flags</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key_flags'>key_flags</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ssl_cipher_filter'>ssl_cipher_filter</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_reuse_flag'>reuse_flag</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;verify_mode=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_verify'>verify</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tls_str'>tls_str</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ca_additions'>ca_additions</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v_flags'>v_flags</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_backlog_str'>backlog_str</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_low_latency_str'>low_latency_str</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="_load_from-instance_method">
  <h3 class='signature  first'>
    #<strong>_load_from</strong>(path)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L129-L136'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='129' data-end='136'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 129</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__load_from'>_load_from</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span>
    <span class='ivar'>@path</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>
    <span class='id identifier rubyid_instance_eval'>instance_eval</span>(<span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_path'>path</span>)<span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='int'>1</span>)
  <span class='kw'>end</span>
<span class='kw'>ensure</span>
  <span class='id identifier rubyid__offer_plugins'><a href="#_offer_plugins-instance_method" title="Puma::DSL#_offer_plugins (method)">_offer_plugins</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_offer_plugins-instance_method">
  <h3 class='signature '>
    #<strong>_offer_plugins</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L138-L147'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='138' data-end='147'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 138</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__offer_plugins'>_offer_plugins</span>
  <span class='ivar'>@plugins</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_o'>o</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_config'>config</span>
      <span class='ivar'>@options</span>.<span class='id identifier rubyid_shift'>shift</span>
      <span class='id identifier rubyid_o'>o</span>.<span class='id identifier rubyid_config'>config</span> <span class='kw'>self</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='ivar'>@plugins</span>.<span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="activate_control_app-instance_method">
  <h3 class='signature '>
    #<strong>activate_control_app</strong>(url = &quot;auto&quot;, opts = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Start the <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> control rack application on <code>url</code>. This application can be communicated with to control the main server. Additionally, you can provide an authentication token, so all requests to the control server will need to include that token as a query parameter. This allows for simple authentication.</p>

<p>Check out <a href="App/Status.html" title="Puma::App::Status (class)"><code>App::Status</code></a> to see what the app has available.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_activate_control_app'>activate_control_app</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unix:///var/run/pumactl.sock</span><span class='tstring_end'>&#39;</span></span></code></pre>
      <pre class='example code ruby'><code><span class='id identifier rubyid_activate_control_app'>activate_control_app</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unix:///var/run/pumactl.sock</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> { <span class='label'>auth_token:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>12345</span><span class='tstring_end'>&#39;</span></span> }</code></pre>
      <pre class='example code ruby'><code><span class='id identifier rubyid_activate_control_app'>activate_control_app</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unix:///var/run/pumactl.sock</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> { <span class='label'>no_token:</span> <span class='kw'>true</span> }</code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L212-L235'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='212' data-end='235'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 212</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_activate_control_app'>activate_control_app</span>(<span class='id identifier rubyid_url'>url</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>auto</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span>{})
  <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>auto</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'><a href="Configuration.html" title="Puma::Configuration (class)">Configuration</a></span>.<span class='id identifier rubyid_temp_path'><a href="Configuration.html#temp_path-class_method" title="Puma::Configuration.temp_path (method)">temp_path</a></span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_control_url'>control_url</span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unix://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_control_url_temp'>control_url_temp</span>] <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>
  <span class='kw'>else</span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_control_url'>control_url</span>] <span class='op'>=</span> <span class='id identifier rubyid_url'>url</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_no_token'>no_token</span>]
    <span class='comment'># We need to use &#39;none&#39; rather than :none because this value will be
</span>    <span class='comment'># passed on to an instance of OptionParser, which doesn&#39;t support
</span>    <span class='comment'># symbols as option values.
</span>    <span class='comment'>#
</span>    <span class='comment'># See: https://github.com/puma/puma/issues/1193#issuecomment-305995488
</span>    <span class='id identifier rubyid_auth_token'>auth_token</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>none</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_auth_token'>auth_token</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_auth_token'>auth_token</span>]
    <span class='id identifier rubyid_auth_token'>auth_token</span> <span class='op'>||=</span> <span class='const'><a href="Configuration.html" title="Puma::Configuration (class)">Configuration</a></span>.<span class='id identifier rubyid_random_token'><a href="Configuration.html#random_token-class_method" title="Puma::Configuration.random_token (method)">random_token</a></span>
  <span class='kw'>end</span>

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_control_auth_token'>control_auth_token</span>] <span class='op'>=</span> <span class='id identifier rubyid_auth_token'>auth_token</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_control_url_umask'>control_url_umask</span>] <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_umask'>umask</span>] <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_umask'>umask</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="add_pem_values_to_options_store-instance_method">
  <h3 class='signature priv'>
    #<strong>add_pem_values_to_options_store</strong>(opts)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>To avoid adding cert_pem and key_pem as URI params, we store them on the <a href=":store">options</a> from where <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> binder knows how to find and extract them.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1073-L1087'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1073' data-end='1087'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1073</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_add_pem_values_to_options_store'>add_pem_values_to_options_store</span>(<span class='id identifier rubyid_opts'>opts</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>defined?</span>(<span class='const'>JRUBY_VERSION</span>)

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_store'>store</span>] <span class='op'>||=</span> []

  <span class='comment'># Store cert_pem and key_pem to options[:store] if present
</span>  [<span class='symbeg'>:</span><span class='id identifier rubyid_cert'>cert</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_key'>key</span>].<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_opt_key'>opt_key</span> <span class='op'>=</span> <span class='symbeg'>:&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>_pem</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='id identifier rubyid_opt_key'>opt_key</span>]
      <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_store'>store</span>].<span class='id identifier rubyid_length'>length</span>
      <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_store'>store</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_opts'>opts</span>[<span class='id identifier rubyid_opt_key'>opt_key</span>]
      <span class='id identifier rubyid_opts'>opts</span>[<span class='id identifier rubyid_v'>v</span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>store:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_index'>index</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="after_worker_boot-instance_method">
  <h3 class='signature '>
    #<strong>after_worker_boot</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#after_worker_fork-instance_method" title="Puma::DSL#after_worker_fork (method)">#after_worker_fork</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L685-L685'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='685' data-end='685'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 685</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_boot'>after_worker_boot</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_fork'><a href="#after_worker_fork-instance_method" title="Puma::DSL#after_worker_fork (method)">after_worker_fork</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="after_worker_fork-instance_method">
  <h3 class='signature '>
    #<strong>after_worker_fork</strong>(&amp;block)  
    <span class='aliases'>Also known as: <span class='names'>#after_worker_boot</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Code to run in the master after a worker has been started. The worker’s index is passed as an argument.</p>

<p>This is called everytime a worker is to be started.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_after_worker_fork'>after_worker_fork</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>After worker fork...</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L679-L683'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='679' data-end='683'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 679</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_after_worker_fork'>after_worker_fork</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_warn_if_in_single_mode'><a href="#warn_if_in_single_mode-instance_method" title="Puma::DSL#warn_if_in_single_mode (method)">warn_if_in_single_mode</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>after_worker_fork</span><span class='tstring_end'>&#39;</span></span>)

  <span class='id identifier rubyid_process_hook'><a href="#process_hook-instance_method" title="Puma::DSL#process_hook (method)">process_hook</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_after_worker_fork'>after_worker_fork</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>after_worker_fork</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="app-instance_method">
  <h3 class='signature '>
    #<strong>app</strong>(obj = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Use an object or block as the rack application. This allows the configuration file to be the application itself.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_app'>app</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>
  <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Hello, World!</span><span class='tstring_end'>&#39;</span></span>

  [
    <span class='int'>200</span><span class='comma'>,</span>
    {
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content-Type</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/plain</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content-Length</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_body'>body</span>.<span class='id identifier rubyid_length'>length</span>.<span class='id identifier rubyid_to_s'>to_s</span>
    }<span class='comma'>,</span>
    [<span class='id identifier rubyid_body'>body</span>]
  ]
<span class='kw'>end</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Configuration.html#app-instance_method" title="Puma::Configuration#app (method)">Configuration#app</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L190-L196'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='190' data-end='196'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 190</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_app'>app</span>(<span class='id identifier rubyid_obj'>obj</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_obj'>obj</span> <span class='op'>||=</span> <span class='id identifier rubyid_block'>block</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Provide either a #call&#39;able or a block</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_obj'>obj</span>

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_app'>app</span>] <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="before_fork-instance_method">
  <h3 class='signature '>
    #<strong>before_fork</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Code to run immediately before master process forks workers (once on boot). These hooks can block if necessary to wait for background operations unknown to <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> to finish before the process terminates. This can be used to close any connections to remote servers (database, Redis, …) that were opened when preloading the code.</p>

<p>This can be called multiple times to add several hooks.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_before_fork'>before_fork</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Starting workers...</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L612-L617'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='612' data-end='617'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 612</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_before_fork'>before_fork</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_warn_if_in_single_mode'><a href="#warn_if_in_single_mode-instance_method" title="Puma::DSL#warn_if_in_single_mode (method)">warn_if_in_single_mode</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>before_fork</span><span class='tstring_end'>&#39;</span></span>)

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_before_fork'>before_fork</span>] <span class='op'>||=</span> []
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_before_fork'>before_fork</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bind-instance_method">
  <h3 class='signature '>
    #<strong>bind</strong>(url)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Bind the server to <code>url</code>. “tcp://”, “unix://” and “ssl://” are the only accepted protocols. Multiple urls can be bound to, calling <code>bind</code> does not overwrite previous bindings.</p>

<p>The default is “tcp://0.0.0.0:9292”.</p>

<p>You can use query parameters within the url to specify options:</p>
<ul><li>
<p>Set the socket backlog depth with <code>backlog</code>, default is 1024.</p>
</li><li>
<p>Set up an SSL certificate with <code>key</code> &amp; <code>cert</code>.</p>
</li><li>
<p>Set up an SSL certificate for mTLS with <code>key</code>, <code>cert</code>, <code>ca</code> and <code>verify_mode</code>.</p>
</li><li>
<p>Set whether to optimize for low latency instead of throughput with <code>low_latency</code>, default is to not optimize for low latency. This is done via <code>Socket::TCP_NODELAY</code>.</p>
</li><li>
<p>Set socket permissions with <code>umask</code>.</p>
</li></ul>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Backlog depth</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind'>bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unix:///var/run/puma.sock?backlog=512</span><span class='tstring_end'>&#39;</span></span></code></pre>
        <p class='example_title'><div class='inline'>
<p>SSL cert</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind'>bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ssl://127.0.0.1:9292?key=key.key&amp;cert=cert.pem</span><span class='tstring_end'>&#39;</span></span></code></pre>
        <p class='example_title'><div class='inline'>
<p>SSL cert for mutual TLS (mTLS)</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind'>bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ssl://127.0.0.1:9292?key=key.key&amp;cert=cert.pem&amp;ca=ca.pem&amp;verify_mode=force_peer</span><span class='tstring_end'>&#39;</span></span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Disable optimization for low latency</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind'>bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp://0.0.0.0:9292?low_latency=false</span><span class='tstring_end'>&#39;</span></span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Socket permissions</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind'>bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unix:///var/run/puma.sock?umask=0111</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Runner.html#load_and_bind-instance_method" title="Puma::Runner#load_and_bind (method)">Runner#load_and_bind</a></li>
          <li><a href="Cluster.html#run-instance_method" title="Puma::Cluster#run (method)">Cluster#run</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L273-L276'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='273' data-end='276'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 273</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bind'>bind</span>(<span class='id identifier rubyid_url'>url</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binds'>binds</span>] <span class='op'>||=</span> []
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binds'>binds</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_url'>url</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bind_to_activated_sockets-instance_method">
  <h3 class='signature '>
    #<strong>bind_to_activated_sockets</strong>(bind = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Bind to (systemd) activated sockets, regardless of configured binds.</p>

<p>Systemd can present sockets as file descriptors that are already opened. By default <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> will use these but only if it was explicitly told to bind to the socket. If not, it will close the activated sockets. This means all configuration is duplicated.</p>

<p>Binds can contain additional configuration, but only SSL config is really relevant since the unix and TCP socket options are ignored.</p>

<p>This means there is a lot of duplicated configuration for no additional value in most setups. This method tells the launcher to bind to all activated sockets, regardless of existing bind.</p>

<p>To clear configured binds, the value only can be passed. This will clear out any binds that may have been configured.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>Use any systemd activated sockets as well as configured binds</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind_to_activated_sockets'>bind_to_activated_sockets</span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Only bind to systemd activated sockets, ignoring other binds</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_bind_to_activated_sockets'>bind_to_activated_sockets</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>only</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L304-L306'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='304' data-end='306'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 304</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bind_to_activated_sockets'>bind_to_activated_sockets</span>(<span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Puma::DSL#bind (method)">bind</a></span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_bind_to_activated_sockets'>bind_to_activated_sockets</span>] <span class='op'>=</span> <span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Puma::DSL#bind (method)">bind</a></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clean_thread_locals-instance_method">
  <h3 class='signature '>
    #<strong>clean_thread_locals</strong>(which = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Work around leaky apps that leave garbage in Thread locals across requests.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L331-L333'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='331' data-end='333'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 331</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clean_thread_locals'>clean_thread_locals</span>(<span class='id identifier rubyid_which'>which</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_clean_thread_locals'>clean_thread_locals</span>] <span class='op'>=</span> <span class='id identifier rubyid_which'>which</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clear_binds!-instance_method">
  <h3 class='signature '>
    #<strong>clear_binds!</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L278-L280'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='278' data-end='280'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 278</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_binds!'>clear_binds!</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_binds'>binds</span>] <span class='op'>=</span> []
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="custom_logger-instance_method">
  <h3 class='signature '>
    #<strong>custom_logger</strong>(custom_logger)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Pass in a custom logging class instance</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L423-L425'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='423' data-end='425'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 423</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_custom_logger'>custom_logger</span>(<span class='id identifier rubyid_custom_logger'>custom_logger</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_custom_logger'>custom_logger</span>] <span class='op'>=</span> <span class='id identifier rubyid_custom_logger'>custom_logger</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="debug-instance_method">
  <h3 class='signature '>
    #<strong>debug</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Show debugging info</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L429-L431'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='429' data-end='431'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 429</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_debug'>debug</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_debug'>debug</span>] <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="default_host-instance_method">
  <h3 class='signature '>
    #<strong>default_host</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L153-L155'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='153' data-end='155'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 153</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_default_host'>default_host</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_default_host'>default_host</span>] <span class='op'>||</span> <span class='const'><a href="Configuration.html" title="Puma::Configuration (class)">Configuration</a></span><span class='op'>::</span><span class='const'><a href="Configuration.html#DEFAULTS-constant" title="Puma::Configuration::DEFAULTS (constant)">DEFAULTS</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_tcp_host'>tcp_host</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="directory-instance_method">
  <h3 class='signature '>
    #<strong>directory</strong>(dir)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The directory to operate out of.</p>

<p>The default is the current directory.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_directory'>directory</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/u/apps/lolcat</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L738-L740'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='738' data-end='740'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 738</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_directory'>directory</span>(<span class='id identifier rubyid_dir'>dir</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_directory'>directory</span>] <span class='op'>=</span> <span class='id identifier rubyid_dir'>dir</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="drain_on_shutdown-instance_method">
  <h3 class='signature '>
    #<strong>drain_on_shutdown</strong>(which = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>When shutting down, drain the accept socket of pending connections and process them. This loops over the accept socket until there are no more read events and then stops looking and waits for the requests to finish.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Server.html#graceful_shutdown-instance_method" title="Puma::Server#graceful_shutdown (method)">Server#graceful_shutdown</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L340-L342'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='340' data-end='342'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 340</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_drain_on_shutdown'>drain_on_shutdown</span>(<span class='id identifier rubyid_which'>which</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_drain_on_shutdown'>drain_on_shutdown</span>] <span class='op'>=</span> <span class='id identifier rubyid_which'>which</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="early_hints-instance_method">
  <h3 class='signature '>
    #<strong>early_hints</strong>(answer = true)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L450-L452'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='450' data-end='452'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 450</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_early_hints'>early_hints</span>(<span class='id identifier rubyid_answer'>answer</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_early_hints'>early_hints</span>] <span class='op'>=</span> <span class='id identifier rubyid_answer'>answer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="environment-instance_method">
  <h3 class='signature '>
    #<strong>environment</strong>(environment)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Set the environment in which the rack’s app will run. The value must be a string.</p>

<p>The default is “development”.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_environment'>environment</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>production</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L351-L353'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='351' data-end='353'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 351</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_environment'>environment</span>(<span class='id identifier rubyid_environment'>environment</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_environment'>environment</span>] <span class='op'>=</span> <span class='id identifier rubyid_environment'>environment</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="extra_runtime_dependencies-instance_method">
  <h3 class='signature '>
    #<strong>extra_runtime_dependencies</strong>(answer = [])  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>When using prune_bundler, if extra runtime dependencies need to be loaded to initialize your app, then this setting can be used. This includes any <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> plugins.</p>

<p>Before bundler is pruned, the gem names supplied will be looked up in the bundler context and then loaded again after bundler is pruned. Only applies if prune_bundler is used.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_extra_runtime_dependencies'>extra_runtime_dependencies</span> [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gem_name_1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gem_name_2</span><span class='tstring_end'>&#39;</span></span>]</code></pre>
      <pre class='example code ruby'><code><span class='id identifier rubyid_extra_runtime_dependencies'>extra_runtime_dependencies</span> [<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>puma_worker_killer</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>puma-heroku</span><span class='tstring_end'>&#39;</span></span>]</code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><code>Puma::Launcher#extra_runtime_deps_directories</code></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L815-L817'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='815' data-end='817'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 815</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_extra_runtime_dependencies'>extra_runtime_dependencies</span>(<span class='id identifier rubyid_answer'>answer</span> <span class='op'>=</span> [])
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_extra_runtime_dependencies'>extra_runtime_dependencies</span>] <span class='op'>=</span> <span class='const'>Array</span>(<span class='id identifier rubyid_answer'>answer</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="first_data_timeout-instance_method">
  <h3 class='signature '>
    #<strong>first_data_timeout</strong>(seconds)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Define how long the tcp socket stays open, if no data has been received.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Server.html#new-class_method" title="Puma::Server.new (method)">Server.new</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L325-L327'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='325' data-end='327'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 325</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_first_data_timeout'>first_data_timeout</span>(<span class='id identifier rubyid_seconds'>seconds</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_first_data_timeout'>first_data_timeout</span>] <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_seconds'>seconds</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="force_shutdown_after-instance_method">
  <h3 class='signature '>
    #<strong>force_shutdown_after</strong>(val = :forever)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>How long to wait for threads to stop when shutting them down. Defaults to <code>:forever</code>. Specifying <code>:immediately</code> will cause <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> to kill the threads immediately.  Otherwise the value is the number of seconds to wait.</p>

<p><a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> always waits a few seconds after killing a thread for it to try to finish up it’s work, even in <code>:immediately</code> mode.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Server.html#graceful_shutdown-instance_method" title="Puma::Server#graceful_shutdown (method)">Server#graceful_shutdown</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L363-L374'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='363' data-end='374'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 363</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_force_shutdown_after'>force_shutdown_after</span>(<span class='id identifier rubyid_val'>val</span><span class='op'>=</span><span class='symbeg'>:</span><span class='id identifier rubyid_forever'>forever</span>)
  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_val'>val</span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_forever'>forever</span>
        <span class='op'>-</span><span class='int'>1</span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_immediately'>immediately</span>
        <span class='int'>0</span>
      <span class='kw'>else</span>
        <span class='const'>Float</span>(<span class='id identifier rubyid_val'>val</span>)
      <span class='kw'>end</span>

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_force_shutdown_after'>force_shutdown_after</span>] <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fork_worker-instance_method">
  <h3 class='signature '>
    #<strong>fork_worker</strong>(after_requests = 1000)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>When enabled, workers will be forked from worker 0 instead of from the master process. This option is similar to <code>preload_app</code> because the app is preloaded before forking, but it is compatible with phased restart.</p>

<p>This option also enables the <code>refork</code> command (SIGURG), which optimizes copy-on-write performance in a running app.</p>

<p>A refork will automatically trigger once after the specified number of requests (default 1000), or pass 0 to disable auto refork.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Version:</p>
<ul class='version'>
  <li>
    <div class='inline'>
<p>5.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1022-L1024'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1022' data-end='1024'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1022</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_fork_worker'>fork_worker</span>(<span class='id identifier rubyid_after_requests'>after_requests</span><span class='op'>=</span><span class='int'>1000</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_fork_worker'>fork_worker</span>] <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_after_requests'>after_requests</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get-instance_method">
  <h3 class='signature '>
    #<strong>get</strong>(key, default = nil)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L161-L163'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='161' data-end='163'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 161</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get'>get</span>(<span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_default'>default</span><span class='op'>=</span><span class='kw'>nil</span>)
  <span class='ivar'>@options</span>[<span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>] <span class='op'>||</span> <span class='id identifier rubyid_default'>default</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="http_content_length_limit-instance_method">
  <h3 class='signature '>
    #<strong>http_content_length_limit</strong>(limit)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The default value for http_content_length_limit is nil.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1065-L1067'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1065' data-end='1067'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1065</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_http_content_length_limit'>http_content_length_limit</span>(<span class='id identifier rubyid_limit'>limit</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_http_content_length_limit'>http_content_length_limit</span>] <span class='op'>=</span> <span class='id identifier rubyid_limit'>limit</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inject-instance_method">
  <h3 class='signature '>
    #<strong>inject</strong>(&amp;blk)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L157-L159'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='157' data-end='159'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 157</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inject'>inject</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
  <span class='id identifier rubyid_instance_eval'>instance_eval</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="io_selector_backend-instance_method">
  <h3 class='signature '>
    #<strong>io_selector_backend</strong>(backend)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specify the backend for the <a href="../IO.html" title="IO (class)"><code>::IO</code></a> selector.</p>

<p>Provided values will be passed directly to <code>NIO::Selector.new</code>, with the exception of <code>:auto</code> which will let nio4r choose the backend.</p>

<p>Check the documentation of <code>NIO::Selector.backends</code> for the list of valid options. Note that the available options on your system will depend on the operating system. If you want to use the pure Ruby backend (not recommended due to its comparatively low performance), set environment variable <code>NIO4R_PURE</code> to <code>true</code>.</p>

<p>The default is <code>:auto</code>.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="https://github.com/socketry/nio4r/blob/master/lib/nio/selector.rb" target="_parent" title="https://github.com/socketry/nio4r/blob/master/lib/nio/selector.rb">https://github.com/socketry/nio4r/blob/master/lib/nio/selector.rb</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1048-L1050'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1048' data-end='1050'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1048</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_io_selector_backend'>io_selector_backend</span>(<span class='id identifier rubyid_backend'>backend</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_io_selector_backend'>io_selector_backend</span>] <span class='op'>=</span> <span class='id identifier rubyid_backend'>backend</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="load-instance_method">
  <h3 class='signature '>
    #<strong>load</strong>(file)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Load additional configuration from a file Files get loaded later via <a href="Configuration.html#load-instance_method" title="Puma::Configuration#load (method)">Configuration#load</a></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L239-L242'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='239' data-end='242'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 239</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_load'>load</span>(<span class='id identifier rubyid_file'>file</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_config_files'>config_files</span>] <span class='op'>||=</span> []
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_config_files'>config_files</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_file'>file</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="log_formatter-instance_method">
  <h3 class='signature '>
    #<strong>log_formatter</strong>(&amp;block)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L467-L469'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='467' data-end='469'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 467</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_log_formatter'>log_formatter</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_log_formatter'>log_formatter</span>] <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="log_requests-instance_method">
  <h3 class='signature '>
    #<strong>log_requests</strong>(which = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Enable request logging</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L418-L420'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='418' data-end='420'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 418</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_log_requests'>log_requests</span>(<span class='id identifier rubyid_which'>which</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_log_requests'>log_requests</span>] <span class='op'>=</span> <span class='id identifier rubyid_which'>which</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="lowlevel_error_handler-instance_method">
  <h3 class='signature '>
    #<strong>lowlevel_error_handler</strong>(obj = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Use <code>obj</code> or <code>block</code> as the low level error handler. This allows the configuration file to change the default error on the server.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_lowlevel_error_handler'>lowlevel_error_handler</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_err'>err</span><span class='op'>|</span>
  [<span class='int'>200</span><span class='comma'>,</span> {}<span class='comma'>,</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>error page</span><span class='tstring_end'>&quot;</span></span>]]
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L759-L763'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='759' data-end='763'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 759</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_lowlevel_error_handler'>lowlevel_error_handler</span>(<span class='id identifier rubyid_obj'>obj</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_obj'>obj</span> <span class='op'>||=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Provide either a #call&#39;able or a block</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_obj'>obj</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_lowlevel_error_handler'>lowlevel_error_handler</span>] <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="max_fast_inline-instance_method">
  <h3 class='signature '>
    #<strong>max_fast_inline</strong>(num_of_requests)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The number of requests to attempt inline before sending a client back to the reactor to be subject to normal ordering.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1029-L1031'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1029' data-end='1031'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1029</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_max_fast_inline'>max_fast_inline</span>(<span class='id identifier rubyid_num_of_requests'>num_of_requests</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_fast_inline'>max_fast_inline</span>] <span class='op'>=</span> <span class='const'>Float</span>(<span class='id identifier rubyid_num_of_requests'>num_of_requests</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="mutate_stdout_and_stderr_to_sync_on_write-instance_method">
  <h3 class='signature '>
    #<strong>mutate_stdout_and_stderr_to_sync_on_write</strong>(enabled = true)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1052-L1054'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1052' data-end='1054'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1052</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_mutate_stdout_and_stderr_to_sync_on_write'>mutate_stdout_and_stderr_to_sync_on_write</span>(<span class='id identifier rubyid_enabled'>enabled</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_mutate_stdout_and_stderr_to_sync_on_write'>mutate_stdout_and_stderr_to_sync_on_write</span>] <span class='op'>=</span> <span class='id identifier rubyid_enabled'>enabled</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_booted-instance_method">
  <h3 class='signature '>
    #<strong>on_booted</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Code to run after puma is booted (works for both: single and clustered)</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_on_booted'>on_booted</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>After booting...</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L693-L695'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='693' data-end='695'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 693</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_booted'>on_booted</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@config</span>.<span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_events'>events</span>].<span class='id identifier rubyid_on_booted'>on_booted</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_refork-instance_method">
  <h3 class='signature '>
    #<strong>on_refork</strong>(key = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode with <a href="#fork_worker-instance_method" title="Puma::DSL#fork_worker (method)">#fork_worker</a> enabled only.</p>
</div>
  </div>


<p>When <a href="#fork_worker-instance_method" title="Puma::DSL#fork_worker (method)">#fork_worker</a> is enabled, code to run in Worker 0 before all other workers are re-forked from this process, after the server has temporarily stopped serving requests (once per complete refork cycle).</p>

<p>This can be used to trigger extra garbage-collection to maximize copy-on-write efficiency, or close any connections to remote servers (database, Redis, …) that were opened while the server was running.</p>

<p>This can be called multiple times to add several hooks.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_on_refork'>on_refork</span> <span class='kw'>do</span>
  <span class='int'>3</span>.<span class='id identifier rubyid_times'>times</span> {<span class='const'>GC</span>.<span class='id identifier rubyid_start'>start</span>}
<span class='kw'>end</span></code></pre>
  </div>
<p class='tag_title'>Version:</p>
<ul class='version'>
  <li>
    <div class='inline'>
<p>5.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L715-L717'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='715' data-end='717'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 715</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_refork'>on_refork</span>(<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_process_hook'><a href="#process_hook-instance_method" title="Puma::DSL#process_hook (method)">process_hook</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_before_refork'>before_refork</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_refork</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_restart-instance_method">
  <h3 class='signature '>
    #<strong>on_restart</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Code to run before doing a restart. This code should close log files, database connections, etc.</p>

<p>This can be called multiple times to add code each time.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_on_restart'>on_restart</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>On restart...</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L385-L388'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='385' data-end='388'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 385</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_restart'>on_restart</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_on_restart'>on_restart</span>] <span class='op'>||=</span> []
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_on_restart'>on_restart</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_worker_boot-instance_method">
  <h3 class='signature '>
    #<strong>on_worker_boot</strong>(key = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Code to run in a worker when it boots to setup the process before booting the app.</p>

<p>This can be called multiple times to add several hooks.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_on_worker_boot'>on_worker_boot</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Before worker boot...</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L629-L633'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='629' data-end='633'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 629</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_worker_boot'>on_worker_boot</span>(<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_warn_if_in_single_mode'><a href="#warn_if_in_single_mode-instance_method" title="Puma::DSL#warn_if_in_single_mode (method)">warn_if_in_single_mode</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_worker_boot</span><span class='tstring_end'>&#39;</span></span>)

  <span class='id identifier rubyid_process_hook'><a href="#process_hook-instance_method" title="Puma::DSL#process_hook (method)">process_hook</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_before_worker_boot'>before_worker_boot</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_worker_boot</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_worker_fork-instance_method">
  <h3 class='signature '>
    #<strong>on_worker_fork</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Code to run in the master right before a worker is started. The worker’s index is passed as an argument.</p>

<p>This can be called multiple times to add several hooks.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_on_worker_fork'>on_worker_fork</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Before worker fork...</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L663-L667'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='663' data-end='667'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 663</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_worker_fork'>on_worker_fork</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_warn_if_in_single_mode'><a href="#warn_if_in_single_mode-instance_method" title="Puma::DSL#warn_if_in_single_mode (method)">warn_if_in_single_mode</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_worker_fork</span><span class='tstring_end'>&#39;</span></span>)

  <span class='id identifier rubyid_process_hook'><a href="#process_hook-instance_method" title="Puma::DSL#process_hook (method)">process_hook</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_before_worker_fork'>before_worker_fork</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_worker_fork</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_worker_shutdown-instance_method">
  <h3 class='signature '>
    #<strong>on_worker_shutdown</strong>(key = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Code to run immediately before a worker shuts down (after it has finished processing HTTP requests). These hooks can block if necessary to wait for background operations unknown to <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> to finish before the process terminates.</p>

<p>This can be called multiple times to add several hooks.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_on_worker_shutdown'>on_worker_shutdown</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>On worker shutdown...</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L647-L651'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='647' data-end='651'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 647</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_worker_shutdown'>on_worker_shutdown</span>(<span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_warn_if_in_single_mode'><a href="#warn_if_in_single_mode-instance_method" title="Puma::DSL#warn_if_in_single_mode (method)">warn_if_in_single_mode</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_worker_shutdown</span><span class='tstring_end'>&#39;</span></span>)

  <span class='id identifier rubyid_process_hook'><a href="#process_hook-instance_method" title="Puma::DSL#process_hook (method)">process_hook</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_before_worker_shutdown'>before_worker_shutdown</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>on_worker_shutdown</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="out_of_band-instance_method">
  <h3 class='signature '>
    #<strong>out_of_band</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Code to run out-of-band when the worker is idle. These hooks run immediately after a request has finished processing and there are no busy threads on the worker. The worker doesn’t accept new requests until this code finishes.</p>

<p>This hook is useful for running out-of-band garbage collection or scheduling asynchronous tasks to execute after a response.</p>

<p>This can be called multiple times to add several hooks.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L728-L730'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='728' data-end='730'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 728</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_out_of_band'>out_of_band</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_process_hook'><a href="#process_hook-instance_method" title="Puma::DSL#process_hook (method)">process_hook</a></span> <span class='symbeg'>:</span><span class='id identifier rubyid_out_of_band'>out_of_band</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>out_of_band</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="persistent_timeout-instance_method">
  <h3 class='signature '>
    #<strong>persistent_timeout</strong>(seconds)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Define how long persistent connections can be idle before <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> closes them.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Server.html#new-class_method" title="Puma::Server.new (method)">Server.new</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L319-L321'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='319' data-end='321'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 319</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_persistent_timeout'>persistent_timeout</span>(<span class='id identifier rubyid_seconds'>seconds</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_persistent_timeout'>persistent_timeout</span>] <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_seconds'>seconds</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pidfile-instance_method">
  <h3 class='signature '>
    #<strong>pidfile</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Store the pid of the server in the file at “path”.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_pidfile'>pidfile</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/u/apps/lolcat/tmp/pids/puma.pid</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L404-L406'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='404' data-end='406'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 404</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_pidfile'>pidfile</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_pidfile'>pidfile</span>] <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="plugin-instance_method">
  <h3 class='signature '>
    #<strong>plugin</strong>(name)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Load the named plugin for use by this configuration</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L167-L169'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='167' data-end='169'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 167</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_plugin'>plugin</span>(<span class='id identifier rubyid_name'>name</span>)
  <span class='ivar'>@plugins</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@config</span>.<span class='id identifier rubyid_load_plugin'>load_plugin</span>(<span class='id identifier rubyid_name'>name</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="port-instance_method">
  <h3 class='signature '>
    #<strong>port</strong>(port, host = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Define the TCP port to bind to. Use <a href="#bind-instance_method" title="Puma::DSL#bind (method)">#bind</a> for more advanced options.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_port'>port</span> <span class='int'>9292</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L312-L315'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='312' data-end='315'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 312</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_port'>port</span>(<span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span><span class='op'>=</span><span class='kw'>nil</span>)
  <span class='id identifier rubyid_host'>host</span> <span class='op'>||=</span> <span class='id identifier rubyid_default_host'><a href="#default_host-instance_method" title="Puma::DSL#default_host (method)">default_host</a></span>
  <span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Puma::DSL#bind (method)">bind</a></span> <span class='const'>URI</span><span class='op'>::</span><span class='const'>Generic</span>.<span class='id identifier rubyid_build'>build</span>(<span class='label'>scheme:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>host:</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='label'>port:</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_port'>port</span>)).<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="preload_app!-instance_method">
  <h3 class='signature '>
    #<strong>preload_app!</strong>(answer = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Preload the application before starting the workers; this conflicts with phased restart feature. On by default if your app uses more than 1 worker.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_preload_app!'>preload_app!</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L748-L750'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='748' data-end='750'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 748</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_preload_app!'>preload_app!</span>(<span class='id identifier rubyid_answer'>answer</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_preload_app'>preload_app</span>] <span class='op'>=</span> <span class='id identifier rubyid_answer'>answer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process_hook-instance_method">
  <h3 class='signature priv'>
    #<strong>process_hook</strong>(options_key, key, block, meth)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1089-L1098'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1089' data-end='1098'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1089</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process_hook'>process_hook</span>(<span class='id identifier rubyid_options_key'>options_key</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_meth'>meth</span>)
  <span class='ivar'>@options</span>[<span class='id identifier rubyid_options_key'>options_key</span>] <span class='op'>||=</span> []
  <span class='kw'>if</span> <span class='const'><a href="#ON_WORKER_KEY-constant" title="Puma::DSL::ON_WORKER_KEY (constant)">ON_WORKER_KEY</a></span>.<span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_class'>class</span>
    <span class='ivar'>@options</span>[<span class='id identifier rubyid_options_key'>options_key</span>] <span class='op'>&lt;&lt;</span> [<span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>]
  <span class='kw'>elsif</span> <span class='id identifier rubyid_key'>key</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='ivar'>@options</span>[<span class='id identifier rubyid_options_key'>options_key</span>] <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_meth'>meth</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; key must be String or Symbol</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prune_bundler-instance_method">
  <h3 class='signature '>
    #<strong>prune_bundler</strong>(answer = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This is incompatible with <a href="#preload_app!-instance_method" title="Puma::DSL#preload_app! (method)">#preload_app!</a>.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This is only supported for RubyGems 2.2+</p>
</div>
  </div>


<p>This option is used to allow your app and its gems to be properly reloaded when not using preload.</p>

<p>When set, if <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> detects that it’s been invoked in the context of Bundler, it will cleanup the environment and re-run itself outside the Bundler environment, but directly using the files that Bundler has setup.</p>

<p>This means that <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> is now decoupled from your Bundler context and when each worker loads, it will be loading a new Bundler context and thus can float around as the release dictates.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="#extra_runtime_dependencies-instance_method" title="Puma::DSL#extra_runtime_dependencies (method)">#extra_runtime_dependencies</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L782-L784'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='782' data-end='784'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 782</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prune_bundler'>prune_bundler</span>(<span class='id identifier rubyid_answer'>answer</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_prune_bundler'>prune_bundler</span>] <span class='op'>=</span> <span class='id identifier rubyid_answer'>answer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="queue_requests-instance_method">
  <h3 class='signature '>
    #<strong>queue_requests</strong>(answer = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>When set to true (the default), workers accept all requests and queue them before passing them to the handlers. When set to false, each worker process accepts exactly as many requests as it is configured to simultaneously handle.</p>

<p>Queueing requests generally improves performance. In some cases, such as a single threaded application, it may be better to ensure requests get balanced across workers.</p>

<p>Note that setting this to false disables HTTP keepalive and slow clients will occupy a handler thread while the request is being sent. A reverse proxy, such as nginx, can handle slow clients and queue requests before they reach <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a>.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Server.html" title="Puma::Server (class)"><code>Server</code></a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L929-L931'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='929' data-end='931'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 929</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_queue_requests'>queue_requests</span>(<span class='id identifier rubyid_answer'>answer</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_queue_requests'>queue_requests</span>] <span class='op'>=</span> <span class='id identifier rubyid_answer'>answer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="quiet-instance_method">
  <h3 class='signature '>
    #<strong>quiet</strong>(which = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Disable request logging, if this isn’t used it’ll be enabled by default.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_quiet'>quiet</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L412-L414'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='412' data-end='414'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 412</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_quiet'>quiet</span>(<span class='id identifier rubyid_which'>which</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_log_requests'><a href="#log_requests-instance_method" title="Puma::DSL#log_requests (method)">log_requests</a></span>] <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_which'>which</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rack_url_scheme-instance_method">
  <h3 class='signature '>
    #<strong>rack_url_scheme</strong>(scheme = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allows setting <code>env[&#39;rack.url_scheme&#39;]</code>. Only necessary if X-Forwarded-Proto is not being set by your proxy Normal values are ‘http’ or ‘https’.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L446-L448'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='446' data-end='448'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 446</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rack_url_scheme'>rack_url_scheme</span>(<span class='id identifier rubyid_scheme'>scheme</span><span class='op'>=</span><span class='kw'>nil</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_rack_url_scheme'>rack_url_scheme</span>] <span class='op'>=</span> <span class='id identifier rubyid_scheme'>scheme</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rackup-instance_method">
  <h3 class='signature '>
    #<strong>rackup</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Load <code>path</code> as a rackup file.</p>

<p>The default is “config.ru”.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_rackup'>rackup</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/u/apps/lolcat/config.ru</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L439-L441'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='439' data-end='441'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 439</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rackup'>rackup</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_rackup'>rackup</span>] <span class='op'>||=</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="raise_exception_on_sigterm-instance_method">
  <h3 class='signature '>
    #<strong>raise_exception_on_sigterm</strong>(answer = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>By default, <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> will raise SignalException when SIGTERM is received. In environments where SIGTERM is something expected, you can suppress these with this option.</p>

<p>This can be useful for example in Kubernetes, where rolling restart is guaranteed usually on infrastructure level.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_raise_exception_on_sigterm'>raise_exception_on_sigterm</span> <span class='kw'>false</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Launcher.html#setup_signals-instance_method" title="Puma::Launcher#setup_signals (method)">Launcher#setup_signals</a></li>
          <li><a href="Cluster.html#setup_signals-instance_method" title="Puma::Cluster#setup_signals (method)">Cluster#setup_signals</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L798-L800'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='798' data-end='800'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 798</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_raise_exception_on_sigterm'>raise_exception_on_sigterm</span>(<span class='id identifier rubyid_answer'>answer</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_raise_exception_on_sigterm'>raise_exception_on_sigterm</span>] <span class='op'>=</span> <span class='id identifier rubyid_answer'>answer</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="restart_command-instance_method">
  <h3 class='signature '>
    #<strong>restart_command</strong>(cmd)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Command to use to restart <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a>. This should be just how to load <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> itself (ie. ‘ruby -Ilib bin/puma’), not the arguments to <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a>, as those are the same as the original process.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_restart_command'>restart_command</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/u/app/lolcat/bin/restart_puma</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L396-L398'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='396' data-end='398'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 396</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_restart_command'>restart_command</span>(<span class='id identifier rubyid_cmd'>cmd</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_restart_cmd'>restart_cmd</span>] <span class='op'>=</span> <span class='id identifier rubyid_cmd'>cmd</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_default_host-instance_method">
  <h3 class='signature '>
    #<strong>set_default_host</strong>(host)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L149-L151'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='149' data-end='151'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 149</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_default_host'>set_default_host</span>(<span class='id identifier rubyid_host'>host</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_default_host'><a href="#default_host-instance_method" title="Puma::DSL#default_host (method)">default_host</a></span>] <span class='op'>=</span> <span class='id identifier rubyid_host'>host</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_remote_address-instance_method">
  <h3 class='signature '>
    #<strong>set_remote_address</strong>(val = :socket)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Control how the remote address of the connection is set. This is configurable because to calculate the true socket peer address a kernel syscall is required which for very fast rack handlers slows down the handling significantly.</p>

<p>There are 5 possible values:</p>
<ol><li>
<p><strong>:socket</strong> (the default) - read the peername from the socket using the syscall. This is the normal behavior. If this fails for any reason (e.g., if the peer disconnects between the connection being accepted and the getpeername system call), Puma will return “0.0.0.0”</p>
</li><li>
<p><strong>:localhost</strong> - set the remote address to “127.0.0.1”</p>
</li><li>
<p>**header: &lt;http_header&gt;**- set the remote address to the value of the provided http header. For instance: ‘set_remote_address header: “X-Real-IP”`. Only the first word (as separated by spaces or comma) is used, allowing headers such as X-Forwarded-For to be used as well. If this header is absent, Puma will fall back to the behavior of :socket</p>
</li><li>
<p>**proxy_protocol: :v1**- set the remote address to the value read from the HAproxy PROXY protocol, version 1. If the request does not have the PROXY protocol attached to it, will fall back to :socket</p>
</li><li>
<p>**&lt;Any string&gt;** - this allows you to hardcode remote address to any value you wish. Because Puma never uses this field anyway, it’s format is entirely in your hands.</p>
</li></ol>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L980-L1007'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='980' data-end='1007'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 980</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_remote_address'>set_remote_address</span>(<span class='id identifier rubyid_val'>val</span><span class='op'>=</span><span class='symbeg'>:</span><span class='id identifier rubyid_socket'>socket</span>)
  <span class='kw'>case</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_socket'>socket</span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address'>remote_address</span>] <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_localhost'>localhost</span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address'>remote_address</span>] <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address_value'>remote_address_value</span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span>.<span class='id identifier rubyid_freeze'>freeze</span>
  <span class='kw'>when</span> <span class='const'>String</span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address'>remote_address</span>] <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>
    <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address_value'>remote_address_value</span>] <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>when</span> <span class='const'>Hash</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_hdr'>hdr</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_header'>header</span>]
      <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address'>remote_address</span>] <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_header'>header</span>
      <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address_header'>remote_address_header</span>] <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_hdr'>hdr</span>.<span class='id identifier rubyid_upcase'>upcase</span>.<span class='id identifier rubyid_tr'>tr</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span>)
    <span class='kw'>elsif</span> <span class='id identifier rubyid_protocol_version'>protocol_version</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_proxy_protocol'>proxy_protocol</span>]
      <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address'>remote_address</span>] <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_proxy_protocol'>proxy_protocol</span>
      <span class='id identifier rubyid_protocol_version'>protocol_version</span> <span class='op'>=</span> <span class='id identifier rubyid_protocol_version'>protocol_version</span>.<span class='id identifier rubyid_downcase'>downcase</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>
      <span class='kw'>unless</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_v1'>v1</span>].<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_protocol_version'>protocol_version</span>)
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid value for proxy_protocol - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_protocol_version'>protocol_version</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_remote_address_proxy_protocol'>remote_address_proxy_protocol</span>] <span class='op'>=</span> <span class='id identifier rubyid_protocol_version'>protocol_version</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid value for set_remote_address - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid value for set_remote_address - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val'>val</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="shutdown_debug-instance_method">
  <h3 class='signature '>
    #<strong>shutdown_debug</strong>(val = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>When a shutdown is requested, the backtraces of all the threads will be written to $stdout. This can help figure out why shutdown is hanging.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L937-L939'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='937' data-end='939'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 937</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_shutdown_debug'>shutdown_debug</span>(<span class='id identifier rubyid_val'>val</span><span class='op'>=</span><span class='kw'>true</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_shutdown_debug'>shutdown_debug</span>] <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="silence_fork_callback_warning-instance_method">
  <h3 class='signature '>
    #<strong>silence_fork_callback_warning</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Disable warning message when running single mode with callback hook defined.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L594-L596'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='594' data-end='596'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 594</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_silence_fork_callback_warning'>silence_fork_callback_warning</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_silence_fork_callback_warning'>silence_fork_callback_warning</span>] <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="silence_single_worker_warning-instance_method">
  <h3 class='signature '>
    #<strong>silence_single_worker_warning</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Disable warning message when running in cluster mode with a single worker.</p>

<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode has some overhead of running an additional ‘control’ process in order to manage the cluster. If only running a single worker it is likely not worth paying that overhead vs running in single mode with additional threads instead.</p>

<p>There are some scenarios where running cluster mode with a single worker may still be warranted and valid under certain deployment scenarios, see <a href="https://github.com/puma/puma/issues/2534">github.com/puma/puma/issues/2534</a></p>

<p>Moving from workers = 1 to workers = 0 will save 10-30% of memory use.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L589-L591'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='589' data-end='591'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 589</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_silence_single_worker_warning'>silence_single_worker_warning</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_silence_single_worker_warning'>silence_single_worker_warning</span>] <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ssl_bind-instance_method">
  <h3 class='signature '>
    #<strong>ssl_bind</strong>(host, port, opts = {})  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Instead of using <a href="#bind-instance_method" title="Puma::DSL#bind (method)">#bind</a> and manually constructing a URI like:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Puma::DSL#bind (method)">bind</a></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ssl://127.0.0.1:9292?key=key_path&amp;cert=cert_path</span><span class='tstring_end'>&#39;</span></span></code></pre>

<p>you can use the this method.</p>

<p>When binding on localhost you don’t need to specify <code>cert</code> and <code>key</code>, <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> will assume you are using the <code>localhost</code> gem and try to load the appropriate files.</p>

<p>When using the options hash parameter, the <code>reuse:</code> value is either <code>true</code>, which sets reuse ‘on’ with default values, or a hash, with <code>:size</code> and/or <code>:timeout</code> keys, each with integer values.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_ssl_bind'>ssl_bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>9292</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> {
  <span class='label'>cert:</span> <span class='id identifier rubyid_path_to_cert'>path_to_cert</span><span class='comma'>,</span>
  <span class='label'>key:</span> <span class='id identifier rubyid_path_to_key'>path_to_key</span><span class='comma'>,</span>
  <span class='label'>ssl_cipher_filter:</span> <span class='id identifier rubyid_cipher_filter'>cipher_filter</span><span class='comma'>,</span> <span class='comment'># optional
</span>  <span class='label'>verify_mode:</span> <span class='id identifier rubyid_verify_mode'>verify_mode</span><span class='comma'>,</span>         <span class='comment'># default &#39;none&#39;
</span>  <span class='label'>verification_flags:</span> <span class='id identifier rubyid_flags'>flags</span><span class='comma'>,</span>        <span class='comment'># optional, not supported by JRuby
</span>  <span class='label'>reuse:</span> <span class='kw'>true</span>                       <span class='comment'># optional
</span>}</code></pre>
        <p class='example_title'><div class='inline'>
<p>Using self-signed certificate with the <code>localhost</code> gem:</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_ssl_bind'>ssl_bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>9292</span><span class='tstring_end'>&#39;</span></span></code></pre>
        <p class='example_title'><div class='inline'>
<p>Alternatively, you can provide <code>cert_pem</code> and <code>key_pem</code>:</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_ssl_bind'>ssl_bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>9292</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> {
  <span class='label'>cert_pem:</span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_path_to_cert'>path_to_cert</span>)<span class='comma'>,</span>
  <span class='label'>key_pem:</span> <span class='const'>File</span>.<span class='id identifier rubyid_read'>read</span>(<span class='id identifier rubyid_path_to_key'>path_to_key</span>)<span class='comma'>,</span>
  <span class='label'>reuse:</span> {<span class='label'>size:</span> <span class='int'>2_000</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='int'>20</span>} <span class='comment'># optional
</span>}</code></pre>
        <p class='example_title'><div class='inline'>
<p>For JRuby, two keys are required: <code>keystore</code> &amp; <code>keystore_pass</code></p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_ssl_bind'>ssl_bind</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>9292</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> {
  <span class='label'>keystore:</span> <span class='id identifier rubyid_path_to_keystore'>path_to_keystore</span><span class='comma'>,</span>
  <span class='label'>keystore_pass:</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span>
  <span class='label'>ssl_cipher_list:</span> <span class='id identifier rubyid_cipher_list'>cipher_list</span><span class='comma'>,</span>     <span class='comment'># optional
</span>  <span class='label'>verify_mode:</span> <span class='id identifier rubyid_verify_mode'>verify_mode</span>          <span class='comment'># default &#39;none&#39;
</span>}</code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L539-L542'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='539' data-end='542'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 539</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_bind'>ssl_bind</span>(<span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'><a href="#port-instance_method" title="Puma::DSL#port (method)">port</a></span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> {})
  <span class='id identifier rubyid_add_pem_values_to_options_store'><a href="#add_pem_values_to_options_store-instance_method" title="Puma::DSL#add_pem_values_to_options_store (method)">add_pem_values_to_options_store</a></span>(<span class='id identifier rubyid_opts'>opts</span>)
  <span class='id identifier rubyid_bind'><a href="#bind-instance_method" title="Puma::DSL#bind (method)">bind</a></span> <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_ssl_bind_str'><a href="#ssl_bind_str-class_method" title="Puma::DSL.ssl_bind_str (method)">ssl_bind_str</a></span>(<span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'><a href="#port-instance_method" title="Puma::DSL#port (method)">port</a></span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="state_path-instance_method">
  <h3 class='signature '>
    #<strong>state_path</strong>(path)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Use <code>path</code> as the file to store the server info state. This is used by <code>pumactl</code> to query and control the server.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_state_path'>state_path</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/u/apps/lolcat/tmp/pids/puma.state</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L549-L551'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='549' data-end='551'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 549</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_state_path'>state_path</span>(<span class='id identifier rubyid_path'>path</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_state'>state</span>] <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="state_permission-instance_method">
  <h3 class='signature '>
    #<strong>state_permission</strong>(permission)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Use <code>permission</code> to restrict permissions for the state file.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_state_permission'>state_permission</span> <span class='int'>0600</span></code></pre>
  </div>
<p class='tag_title'>Version:</p>
<ul class='version'>
  <li>
    <div class='inline'>
<p>5.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L559-L561'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='559' data-end='561'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 559</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_state_permission'>state_permission</span>(<span class='id identifier rubyid_permission'>permission</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_state_permission'>state_permission</span>] <span class='op'>=</span> <span class='id identifier rubyid_permission'>permission</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="stdout_redirect-instance_method">
  <h3 class='signature '>
    #<strong>stdout_redirect</strong>(stdout = nil, stderr = nil, append = false)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Redirect <code>STDOUT</code> and <code>STDERR</code> to files specified. The <code>append</code> parameter specifies whether the output is appended, the default is <code>false</code>.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_stdout_redirect'>stdout_redirect</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/app/lolcat/log/stdout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/app/lolcat/log/stderr</span><span class='tstring_end'>&#39;</span></span></code></pre>
      <pre class='example code ruby'><code><span class='id identifier rubyid_stdout_redirect'>stdout_redirect</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/app/lolcat/log/stdout</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/app/lolcat/log/stderr</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L461-L465'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='461' data-end='465'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 461</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_stdout_redirect'>stdout_redirect</span>(<span class='id identifier rubyid_stdout'>stdout</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_stderr'>stderr</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_append'>append</span><span class='op'>=</span><span class='kw'>false</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_redirect_stdout'>redirect_stdout</span>] <span class='op'>=</span> <span class='id identifier rubyid_stdout'>stdout</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_redirect_stderr'>redirect_stderr</span>] <span class='op'>=</span> <span class='id identifier rubyid_stderr'>stderr</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_redirect_append'>redirect_append</span>] <span class='op'>=</span> <span class='id identifier rubyid_append'>append</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="tag-instance_method">
  <h3 class='signature '>
    #<strong>tag</strong>(string)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Additional text to display in process listing.</p>

<p>If you do not specify a tag, <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> will infer it. If you do not want <a href="../Puma.html" title="Puma (module)"><code>::Puma</code></a> to add a tag, use an empty string.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_tag'>tag</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>app name</span><span class='tstring_end'>&#39;</span></span></code></pre>
      <pre class='example code ruby'><code><span class='id identifier rubyid_tag'>tag</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L828-L830'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='828' data-end='830'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 828</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_tag'>tag</span>(<span class='id identifier rubyid_string'>string</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_tag'>tag</span>] <span class='op'>=</span> <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="threads-instance_method">
  <h3 class='signature '>
    #<strong>threads</strong>(min, max)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Configure <code>min</code> to be the minimum number of threads to use to answer requests and <code>max</code> the maximum.</p>

<p>The default is the environment variables <code>PUMA_MIN_THREADS</code> / <code>PUMA_MAX_THREADS</code> (or <code>MIN_THREADS</code> / <code>MAX_THREADS</code> if the <code>PUMA_</code> variables aren’t set).</p>

<p>If these environment variables aren’t set, the default is “0, 5” in MRI or “0, 16” for other interpreters.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_threads'>threads</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>16</span></code></pre>
      <pre class='example code ruby'><code><span class='id identifier rubyid_threads'>threads</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>5</span></code></pre>
  </div>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L483-L496'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='483' data-end='496'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 483</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_threads'>threads</span>(<span class='id identifier rubyid_min'>min</span><span class='comma'>,</span> <span class='id identifier rubyid_max'>max</span>)
  <span class='id identifier rubyid_min'>min</span> <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_min'>min</span>)
  <span class='id identifier rubyid_max'>max</span> <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_max'>max</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_min'>min</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_max'>max</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The minimum (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_min'>min</span><span class='embexpr_end'>}</span><span class='tstring_content'>) number of threads must be less than or equal to the max (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max'>max</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_max'>max</span> <span class='op'>&lt;</span> <span class='int'>1</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The maximum number of threads (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max'>max</span><span class='embexpr_end'>}</span><span class='tstring_content'>) must be greater than 0</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_min_threads'>min_threads</span>] <span class='op'>=</span> <span class='id identifier rubyid_min'>min</span>
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_max_threads'>max_threads</span>] <span class='op'>=</span> <span class='id identifier rubyid_max'>max</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="wait_for_less_busy_worker-instance_method">
  <h3 class='signature '>
    #<strong>wait_for_less_busy_worker</strong>(val = 0.005)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Attempts to route traffic to less-busy workers by causing them to delay listening on the socket, allowing workers which are not processing any requests to pick up new requests first.</p>

<p>Only works on MRI. For all other interpreters, this setting does nothing.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Server.html#handle_servers-instance_method" title="Puma::Server#handle_servers (method)">Server#handle_servers</a></li>
          <li><a href="ThreadPool.html#wait_for_less_busy_worker-instance_method" title="Puma::ThreadPool#wait_for_less_busy_worker (method)">ThreadPool#wait_for_less_busy_worker</a></li>
      </ul>
<p class='tag_title'>Version:</p>
<ul class='version'>
  <li>
    <div class='inline'>
<p>5.0.0</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L951-L953'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='951' data-end='953'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 951</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_wait_for_less_busy_worker'>wait_for_less_busy_worker</span>(<span class='id identifier rubyid_val'>val</span><span class='op'>=</span><span class='float'>0.005</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_wait_for_less_busy_worker'>wait_for_less_busy_worker</span>] <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>.<span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="warn_if_in_single_mode-instance_method">
  <h3 class='signature priv'>
    #<strong>warn_if_in_single_mode</strong>(hook_name)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L1100-L1111'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1100' data-end='1111'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 1100</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_warn_if_in_single_mode'>warn_if_in_single_mode</span>(<span class='id identifier rubyid_hook_name'>hook_name</span>)
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_silence_fork_callback_warning'><a href="#silence_fork_callback_warning-instance_method" title="Puma::DSL#silence_fork_callback_warning (method)">silence_fork_callback_warning</a></span>]

  <span class='kw'>if</span> (<span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_workers'><a href="#workers-instance_method" title="Puma::DSL#workers (method)">workers</a></span>] <span class='op'>||</span> <span class='int'>0</span>) <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_log_string'>log_string</span> <span class='op'>=</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Warning: You specified code to run in a `</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hook_name'>hook_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>` block, </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>but Puma is not configured to run in cluster mode (worker count &gt; 0 ), </span><span class='tstring_end'>&quot;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>so your `</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hook_name'>hook_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>` block did not run</span><span class='tstring_end'>&quot;</span></span>

    <span class='const'><a href="LogWriter.html" title="Puma::LogWriter (class)">LogWriter</a></span>.<span class='id identifier rubyid_stdio'><a href="LogWriter.html#stdio-class_method" title="Puma::LogWriter.stdio (method)">stdio</a></span>.<span class='id identifier rubyid_log'>log</span>(<span class='id identifier rubyid_log_string'>log_string</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_boot_timeout-instance_method">
  <h3 class='signature '>
    #<strong>worker_boot_timeout</strong>(timeout)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Change the default worker timeout for booting.</p>

<p>If unspecified, this defaults to the value of worker_timeout.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_worker_boot_timeout'>worker_boot_timeout</span> <span class='int'>60</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><code>Puma::Cluster::Worker#ping_timeout</code></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L878-L880'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='878' data-end='880'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 878</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_boot_timeout'>worker_boot_timeout</span>(<span class='id identifier rubyid_timeout'>timeout</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_worker_boot_timeout'>worker_boot_timeout</span>] <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_timeout'>timeout</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_check_interval-instance_method">
  <h3 class='signature '>
    #<strong>worker_check_interval</strong>(interval)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Change the default interval for checking workers.</p>

<p>The default value is 5 seconds.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_worker_check_interval'>worker_check_interval</span> <span class='int'>5</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Cluster.html#check_workers-instance_method" title="Puma::Cluster#check_workers (method)">Cluster#check_workers</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L841-L843'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='841' data-end='843'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 841</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_check_interval'>worker_check_interval</span>(<span class='id identifier rubyid_interval'>interval</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_worker_check_interval'>worker_check_interval</span>] <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_interval'>interval</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_culling_strategy-instance_method">
  <h3 class='signature '>
    #<strong>worker_culling_strategy</strong>(strategy)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Set the strategy for worker culling.</p>

<p>There are two possible values:</p>
<ol><li>
<p><strong>:youngest</strong> - the youngest workers (i.e. the workers that were the most recently started) will be culled.</p>
</li><li>
<p><strong>:oldest</strong> - the oldest workers (i.e. the workers that were started the longest time ago) will be culled.</p>
</li></ol>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_worker_culling_strategy'>worker_culling_strategy</span> <span class='symbeg'>:</span><span class='id identifier rubyid_oldest'>oldest</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Cluster.html#cull_workers-instance_method" title="Puma::Cluster#cull_workers (method)">Cluster#cull_workers</a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L905-L913'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='905' data-end='913'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 905</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_culling_strategy'>worker_culling_strategy</span>(<span class='id identifier rubyid_strategy'>strategy</span>)
  <span class='id identifier rubyid_stategy'>stategy</span> <span class='op'>=</span> <span class='id identifier rubyid_strategy'>strategy</span>.<span class='id identifier rubyid_to_sym'>to_sym</span>

  <span class='kw'>if</span> <span class='op'>!</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_youngest'>youngest</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_oldest'>oldest</span>].<span class='id identifier rubyid_include?'>include?</span>(<span class='id identifier rubyid_strategy'>strategy</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid value for worker_culling_strategy - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stategy'>stategy</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_worker_culling_strategy'>worker_culling_strategy</span>] <span class='op'>=</span> <span class='id identifier rubyid_strategy'>strategy</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_shutdown_timeout-instance_method">
  <h3 class='signature '>
    #<strong>worker_shutdown_timeout</strong>(timeout)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Set the timeout for worker shutdown.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><code>Puma::Cluster::Worker#term</code></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L887-L889'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='887' data-end='889'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 887</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_shutdown_timeout'>worker_shutdown_timeout</span>(<span class='id identifier rubyid_timeout'>timeout</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_worker_shutdown_timeout'>worker_shutdown_timeout</span>] <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_timeout'>timeout</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_timeout-instance_method">
  <h3 class='signature '>
    #<strong>worker_timeout</strong>(timeout)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>Verifies that all workers have checked in to the master process within the given timeout. If not the worker process will be restarted. This is not a request timeout, it is to protect against a hung or dead process. Setting this value will not protect against slow requests.</p>

<p>The minimum value is 6 seconds, the default value is 60 seconds.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_worker_timeout'>worker_timeout</span> <span class='int'>60</span></code></pre>
  </div>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><code>Puma::Cluster::Worker#ping_timeout</code></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L857-L866'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='857' data-end='866'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 857</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_worker_timeout'>worker_timeout</span>(<span class='id identifier rubyid_timeout'>timeout</span>)
  <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='const'>Integer</span>(<span class='id identifier rubyid_timeout'>timeout</span>)
  <span class='id identifier rubyid_min'>min</span> <span class='op'>=</span> <span class='ivar'>@options</span>.<span class='id identifier rubyid_fetch'>fetch</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_worker_check_interval'><a href="#worker_check_interval-instance_method" title="Puma::DSL#worker_check_interval (method)">worker_check_interval</a></span><span class='comma'>,</span> <span class='const'><a href="Configuration.html" title="Puma::Configuration (class)">Configuration</a></span><span class='op'>::</span><span class='const'><a href="Configuration.html#DEFAULTS-constant" title="Puma::Configuration::DEFAULTS (constant)">DEFAULTS</a></span>[<span class='symbeg'>:</span><span class='id identifier rubyid_worker_check_interval'><a href="#worker_check_interval-instance_method" title="Puma::DSL#worker_check_interval (method)">worker_check_interval</a></span>])

  <span class='kw'>if</span> <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_min'>min</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The minimum worker_timeout must be greater than the worker reporting interval (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_min'>min</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_worker_timeout'>worker_timeout</span>] <span class='op'>=</span> <span class='id identifier rubyid_timeout'>timeout</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="workers-instance_method">
  <h3 class='signature '>
    #<strong>workers</strong>(count)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a> mode only.</p>
</div>
  </div>


<p>How many worker processes to run.  Typically this is set to the number of available cores.</p>

<p>The default is the value of the environment variable <code>WEB_CONCURRENCY</code> if set, otherwise 0.</p>

  </div>
</div>
<div class='tags'>
    <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Cluster.html" title="Puma::Cluster (class)"><code>Cluster</code></a></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/puma/puma/blob/v6.2.1/lib/puma/dsl.rb#L571-L573'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='571' data-end='573'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/puma/dsl.rb', line 571</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_workers'>workers</span>(<span class='id identifier rubyid_count'>count</span>)
  <span class='ivar'>@options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_workers'>workers</span>] <span class='op'>=</span> <span class='id identifier rubyid_count'>count</span>.<span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>